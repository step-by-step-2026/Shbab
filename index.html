<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>خطوتك - ابني مستقبلك</title>
<meta name="description" content="خطوتك: اختبارات، خطط تعلم يومية، مشاريع وفرص تدريبية للشباب">
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0f172a; --card:#1e293b; --accent:#22c55e; --accent2:#d4af37; --text:#e6edf3; --shadow:0 8px 20px rgba(0,0,0,0.6);
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Cairo',sans-serif;background:linear-gradient(180deg,#0f172a,#071024);color:var(--text);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;}
.container{max-width:720px;width:100%;background:var(--card);border-radius:15px;box-shadow:var(--shadow);padding:30px;animation:fadeIn 1s ease-out;}
h1{font-size:28px;color:var(--accent2);margin-bottom:12px;}
p{font-size:16px;color:rgba(230,237,243,0.9);margin-bottom:20px;}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:20px;}
.btn{display:flex;align-items:center;justify-content:center;gap:8px;background:var(--accent);color:#042019;font-weight:700;padding:14px;border-radius:12px;cursor:pointer;transition:0.3s;font-size:16px;box-shadow:0 4px 15px rgba(0,0,0,0.4);}
.btn:hover{background:var(--accent2);color:#fff;transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.6);}
.hr{border:none;border-top:1px solid rgba(255,255,255,0.08);margin:20px 0;}
small{display:block;text-align:center;color:rgba(230,237,243,0.6);margin-top:10px;}
.hide{display:none;}
.card{background:#1f2937;padding:15px;border-radius:12px;margin-bottom:15px;}
.card h3{margin-bottom:6px;color:var(--accent2);}
.card p{margin-bottom:4px;color:#e6edf3;font-size:14px;}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
</style>
</head>
<body>

<div class="container" id="app">

  <!-- صفحة البداية -->
  <div id="home">
    <h1>أهلاً بك في خطوتك</h1>
    <p>ابدأ رحلة بناء مستقبلك: اختبر مجالك، تعلم خطوة يوميًا، وابدأ مشروعك بدون أي تكلفة.</p>
    <div class="grid">
      <div class="btn" id="googleSign">تسجيل دخول Google</div>
      <div class="btn" id="guest">جرب كزائر</div>
    </div>
    <hr class="hr">
    <small>نسخة تجريبية — جاهزة للتطوير وربطها بقاعدة بيانات Firebase.</small>
  </div>

  <!-- صفحة اختبار المجال -->
  <div id="quiz" class="hide">
    <h1>اختبر مجالك</h1>
    <div id="questionContainer"></div>
    <div class="grid">
      <div class="btn" id="nextQuestion">التالي</div>
      <div class="btn" id="finishQuiz">إنهاء الاختبار</div>
    </div>
    <hr class="hr">
    <small>اختبر 10 أسئلة لمعرفة أفضل 3 مجالات مناسبة لك.</small>
  </div>

  <!-- صفحة الخطة 30 يوم -->
  <div id="plan" class="hide">
    <h1>خطة 30 يوم</h1>
    <div id="planContainer"></div>
    <div class="btn" id="backHome">العودة للصفحة الرئيسية</div>
  </div>

  <!-- صفحة المشاريع -->
  <div id="projects" class="hide">
    <h1>مشاريع جاهزة للشباب</h1>
    <div id="projectsContainer"></div>
    <div class="btn" id="backHome2">العودة للصفحة الرئيسية</div>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-auth.js";
import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDpVqFWJfB4rA2-NA4QIl1w07e2LFQaYic",
  authDomain: "tourguideapp-313c1.firebaseapp.com",
  databaseURL: "https://tourguideapp-313c1-default-rtdb.firebaseio.com",
  projectId: "tourguideapp-313c1",
  storageBucket: "tourguideapp-313c1.appspot.com",
  messagingSenderId: "1036127588385",
  appId: "1:1036127588385:web:4924705000167b06395360"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// -------- الصفحة الرئيسية --------
const home = document.getElementById('home');
const quizPage = document.getElementById('quiz');
const planPage = document.getElementById('plan');
const projectsPage = document.getElementById('projects');

document.getElementById('googleSign').addEventListener('click', async () => {
  const provider = new GoogleAuthProvider();
  try {
    const result = await signInWithPopup(auth, provider);
    const user = result.user;
    await setDoc(doc(db,"users",user.uid),{
      name:user.displayName,
      email:user.email,
      photo:user.photoURL,
      createdAt:serverTimestamp()
    },{merge:true});
    alert(`تم تسجيل الدخول. أهلاً ${user.displayName}`);
    showQuiz();
  } catch(e){ console.error(e); alert(`حدث خطأ: ${e.message}`);}
});

document.getElementById('guest').addEventListener('click', () => { showQuiz(); });

// -------- وظائف SPA --------
function hideAll(){ home.classList.add('hide'); quizPage.classList.add('hide'); planPage.classList.add('hide'); projectsPage.classList.add('hide'); }

function showQuiz(){ hideAll(); quizPage.classList.remove('hide'); startQuiz(); }
function showPlan(){ hideAll(); planPage.classList.remove('hide'); loadPlan(); }
function showProjects(){ hideAll(); projectsPage.classList.remove('hide'); loadProjects(); }
document.getElementById('backHome').addEventListener('click', ()=>{ hideAll(); home.classList.remove('hide'); });
document.getElementById('backHome2').addEventListener('click', ()=>{ hideAll(); home.classList.remove('hide'); });

// -------- اختبار المجال --------
const questions = [
  {q:"تحب العمل مع الحاسوب؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب تصميم الأشياء؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب الرياضيات والمنطق؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب الكتابة والتواصل؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب قيادة المشاريع؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب المبيعات والتسويق؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب المساعدة الإنسانية؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب حل المشاكل التقنية؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب الإبداع والفن؟", options:["نعم","لا","أحياناً"]},
  {q:"تحب تنظيم الأحداث والفعاليات؟", options:["نعم","لا","أحياناً"]}
];

let currentQ=0, answers=[];

const questionContainer = document.getElementById('questionContainer');
const nextBtn = document.getElementById('nextQuestion');
const finishBtn = document.getElementById('finishQuiz');

function startQuiz(){
  currentQ=0; answers=[];
  renderQuestion();
}

function renderQuestion(){
  const q = questions[currentQ];
  let html = `<h2>${q.q}</h2>`;
  q.options.forEach(opt=>{
    html += `<div class="btn option">${opt}</div>`;
  });
  questionContainer.innerHTML = html;
  document.querySelectorAll('.option').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      answers[currentQ]=btn.innerText;
    });
  });
}

nextBtn.addEventListener('click', ()=>{
  if(currentQ<questions.length-1){ currentQ++; renderQuestion(); }else{ alert('هذا آخر سؤال، اضغط إنهاء الاختبار'); }
});

finishBtn.addEventListener('click', ()=>{
  if(answers.length<questions.length){ alert('أجب على كل الأسئلة'); return;}
  saveResult();
});

async function saveResult(){
  try{
    const user = auth.currentUser;
    if(user){
      await setDoc(doc(db,"results",user.uid),{answers, createdAt:serverTimestamp()},{merge:true});
    }
  }catch(e){console.error(e);}
  alert("تم حفظ إجاباتك!");
  showPlan();
}

// -------- خطة 30 يوم --------
const planContainer = document.getElementById('planContainer');
function loadPlan(){
  const tasks = [];
  for(let i=1;i<=30;i++){
    tasks.push({day:i,task:`المهمة اليومية رقم ${i}`});
  }
  let html='';
  tasks.forEach(t=>{
    html+=`<div class="card"><h3>اليوم ${t.day}</h3><p>${t.task}</p></div>`;
  });
  planContainer.innerHTML = html;
}

// -------- المشاريع --------
const projectsContainer = document.getElementById('projectsContainer');
function loadProjects(){
  const projects = [
    {title:"مشروع تصميم لوجو", desc:"ابدأ بتصميم لوجوهات بسيطة"},
    {title:"مشروع كتابة محتوى", desc:"ابدأ بكتابة مقالات قصيرة"},
    {title:"مشروع قناة يوتيوب", desc:"ابدأ بفيديوهات قصيرة"},
    {title:"مشروع متجر إلكتروني صغير", desc:"ابدأ ببيع منتجات بسيطة"}
  ];
  let html='';
  projects.forEach(p=>{
    html+=`<div class="card"><h3>${p.title}</h3><p>${p.desc}</p></div>`;
  });
  projectsContainer.innerHTML = html;
}
</script>

</body>
</html>
